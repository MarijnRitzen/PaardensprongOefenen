$('.grid-item:not(.center)').fitText(0.15);

let wordString = "aandrang aanwinst aanrecht aandacht aambeeld aanhoren afvalzak afwasbak afwassen afwezige alchemie allemaal afstoten algemeen allergie afwijzen alarmbel bekertje bedanken bedenken beginner bekeuren bekijken bekleden bedelaar biertent bezwaren bierbuik blikvoer bloembol bloedbad bloedvat bladgoud bioritme bijziend bisschop blijheid bloemist bijstand bilspier biograaf bladhout blessure biologen bloempot blokkade bloembak buikwond brochure brandbom bullebak broodmes breiwerk braadpan bungalow briljant charmant campagne buskaart bustocht ceintuur charisma chantage capsules centraal campings celibaat charmeur carillon carnaval catering celliste celstraf conditie comeback couveuse creaties creatief cursiste constant commotie collecte crematie compleet criteria dansfilm dageraad dagdroom dakramen danspaal databank debutant debatten dankbaar dagtocht dageraad darmwand danseres dakkapel dartbord deegwaar deadline dagkaart dagtaken debiteur damsport dagomzet defensie diameter diabetes denkfout dezelfde deugniet delirium desolaat diagnose desnoods deurpost deeltaxi designer diefstal dierbaar directie dodencel doopceel donateur doelpunt digibeet dimensie dodenrit doopjurk doodziek doodslag dimlicht digitaal dievegge diepgang dirigent doorgang dominant dijbenen dienblad diffusie dijspier doodstil document diervoer difterie dividend dompelen dompteur dikwijls drijfnat duikfles drukwerk drumstok dranghek driehoek drugtest duurzaam druppels drukfout dwangsom droogrek duinroos drumsolo drukinkt dressoir drukplek echtpaar economie eetkamer eisprong elleboog eigendom eekhoorn eerwraak eierdoos eerzucht eetpauze eiwitten ellendig elastiek eettafel eindnota eikentak eindzege eeltlaag ecologie economen eentonig eetbuien eicellen eierstok eigenaar eetgerei educatie empathie episodes epidemie enclaves ereteken ergernis explosie evenaren erewraak erfrente ervaring ensemble energiek ereronde eurozone expansie eyeliner evolutie essentak erfzonde erelijst essentie failliet facelift favoriet fileleed flexibel filmster fijnstof festival farmacie fietsbel fietspad flapdrol fietsbus fantasie factoren feilbaar fietsrek filteren flaporen fanatiek feilloos fietstas filmdiva flamingo filmdoek facturen fabuleus feminist feedback fauteuil flaneren feestdag fungeren fotoblad fulltime frequent frietzak fraudeur fruitsap frikadel foutloos fractuur fruithap fragment frappant framboos gangetje gaskabel gastkoor gangkast gasmeter gasketel gaskraan gastvrij galsteen galajurk gastheer galwegen garnalen gebraden geborgen gebeente geestige gebulder geblader gebreken gedrocht gedroogd gedeelte gebruikt gebeuren geboorte gedaagde gegevens gedweild gebleekt gedaante gedonder geduldig gefocust gedachte gebitjes gekietel geldezel geldroof geldgids gekeuvel geleider gelispel geintjes gekibbel geldkist geliefde gemeente gelovige geldlade gekroond geluiden geloftes gekwetst geluidje gesabbel gepoetst genezing genocide gentiaan gepieker geseling genodigd genereus gerommel geriater gerammel generiek geritsel geslaagd gerochel geneuzel genitaal geograaf geranium geroddel geslacht genetica gipswand gewricht gifbeker glaswand gezellig gewoonte gidsland glaswerk gitarist gladheid giebelen gitzwart glijvlak glorieus gijzelen gletsjer geweldig gewillig glansrol gisteren graffiti granaten golfclub golfbaan gradatie grafkist goedheid graficus grijparm groenbak groenten grasrand grachtenhaalbaar handdoek hangsnor hazenlip halslijn halfstok haartype haarverf handzaam harmonie hangkast haakneus handzeep hartzeer harpiste hardheid handboei halogeen haarwerk hagelbui handboek handpalm haarloos haarband haarstuk halsband handicap hartslag harttoon hangslot helemaal helpdesk hoektand hoefsmid hielprik historie hersenen hologram hematoom heilzaam heleboel herhalen hoestbui hoofdvak huisarts hulplijn huisbaas houtworm hoogstam hoektand huidarts houtzaag huismerk hulppost huilbaby houtlijm houtboor hoofdzin hooivork hopeloos houdbaar hulphond huiswerk huilerig hormonen hooiberg hoofdsom honkvast hondsmoe hotelbar huisraad hulpteam hotelbed hoestbui huwelijk humorist huurhuis humanist huurauto humeurig huurbaas ijsbeker ijssalon ijswafel infectie indeling ijspegel idealist inflatie illegaal identiek imposant inboedel illusies impotent infobord inclusie ijshoorn indianen individu inbreker inleider inspraak inruilen injectie inktvlek insuline insignes instinct innemend internet inlegvel inlander interval jaarnota jeeptour jongleur jeugdlid jachthut jaarplan jaarrede kaalslag kaasrasp kaasboer kaassaus jaargang judobond jongeman jointjes juffrouw jihadist jongetje journaal jubileum jaarloon jonagold kaaklijn kaderlid kaarsvet kaakklem kaakbeen kademuur juwelier kabouter kaaklijn kantlijn kastwand keerpunt keramiek kampioen kasplant kamerjas kapitein kalifaat kassabon kalender kansloos kapsalon kenteken kerfstok kampvuur kameleon katapult keelpijn keuzevak klassiek keukenla kiesraad klaproos kletsnat kiestoon kernteam klapvoet kinetica klaplong kerosine klarinet kleedhok klemtoon kinderen kiespijn kilogram klimroos klokslag kniepees knelpunt kneuzing knalpijp kniekous kniesoor kniestuk knotwilg klokhuis koelkast kogelgat klooster kookstel kookstel koopwaar krasvrij krijtwit kookboek koolzuur koningin koolmees kopschuw kraambed kostbaar kopgroep koophuis koufront koosnaam kookpunt kolibrie koptekst koukleum kraampje krultang kuisheid kunstoog laagbouw laconiek kruising kruipgat krulhaar laadklep lachfilm laadpaal kunstijs kwartier ladekast laborant kruisbes krokodil kwadraat labyrint kroepoek lantaarn lavendel leergeld lakenzak ledikant leerzaam leesfout leeftijd ledemaat leefbaar leeshoek leerjaar lamsbout langzaam leeslamp landgoed laveloos ledental leerdoel leesboek leesbril lastpost lammetje landbouw leesclub legertop lentezon lekkages legitiem lentedag lidwoord lijfarts linoleum literpak lijkkist ligstoel litteken lockdown lintworm lingerie lesgroep longarts limonade lichting longfoto lijkauto leukemie ligfiets lipstick loopgips lucifers maagwand maagzuur maiskolf madelief maagband loodvrij loopband loverboy luipaard magazijn magazine luchtbel maagpijn macaroni lotgeval loofhout luchtweg lymfevat maatstaf maakloon luiertas loopneus mediabox margriet malafide marktdag meetlint matzwart mascotte mediawet marinier manifest marionet medicijn makelaar marathon meervoud meetfout medemens matiging megadeal melkkuur meimaand meldpunt meikever megastal melkboer meidoorn meldcode megafoon melanoom melkzuur metafoor metgezel minnares misdrijf mijlpaal memoriam methoden meniscus merknaam metworst militair misbruik miskraam membraan migraine minteken memoblok memobord mensheid mergpijp metabool misstand miskleun modegril morsdood motregen monddood monoloog monument motoriek mondgeur mistlamp modeshow moeizaam mondharp motorjas muilkorf mondzorg modemerk monogaam molecuul modeblad molenaar motorrit muisklik monotoon muntstuk muurkast naaister narcisme neerslag muurlamp muntthee naaldbos nachtpon naaldhak nachtrit muurvast muurverf naturist neuspunt netvlies nekspier nekschot nekkramp nicotine nietsnut noodzaak oefening ogenblik olijftak nulstand november oldtimer olieveld obsessie noodplan noodhulp olievlek obesitas noodsein nijptang obstakel oersterk noodknop noodstop noodtrap noodweer onbewust onderrug oneervol oneindig oncoloog onbegrip ongehuwd ondiepte omnivoor onaardig onderarm onbemand onderlip onderdak ongeacht ongeldig ongewoon onkosten ongenade onrustig ongelijk ontroerd ongepast ongeveer ongeloof onhandig onthutst oordelen onzijdig oogholte oorsmeer oogharen oogspier ooievaar oogappel oogvocht oogkwaal onveilig oordopje overtrek paashaas papegaai paspoort overkant pandemie parttime pashokje panorama overmoed paartijd palmolie pantalon parochie paskamer overname overloop paasbest pastorie parasiet paradijs panellid ozonlaag overspel paleisje pancreas password opgefokt openbaar opkikker operette opgevoed oppasser operatie ophoping opleider oppepper orgelles opsteker opponent oppergod optimist orkesten organist opzouten oppasser opstapje opticien orchidee opwarmer orthodox ordinair oudtante ovenwant overhemd overkant overmoed overrijp overlast overname oventijd overdruk overgave overdaad ovenvers peulerwt phishing picknick pijnbank piepjong pianiste pechhulp patserig peiljaar perensap pijnboom pijnpoli pikzwart pieptoon perziken peilloos piekeren pianoles pelotons pedicure pedagoog pensioen pijnvrij piekhaar persfoto peilstok pijlsnel pelikaan peetzoon plechtig politiek pokdalig pluktuin piramide plakband polsstok pluimvee plantage pistolet plensbui poeslief platvoet popgroep postcode proefrit praktijk printkop potplant positief populier postduif prikklok populist polsslag pretogen principe potgrond precisie prognose pretpark preisoep postbode puinhoop prothese pruillip proviand prostaat promotie psychose putlucht pyromaan punkband puntgaaf puntmuts punthoed quizteam raaklijn raceboot ramkraak recensie raadslid recidief rebellie reacties rabarber raamwerk rantsoen receptie raadzaal raadzaam radiator realisme rangorde radicaal ratjetoe rampjaar raadhuis racebaan randstad rauwkost razernij recreant reisduur rekenles reisgeld reiswieg rekensom rendabel resoluut relikwie reisgids regenbui redelijk regendag register reiniger reiziger richting regenton regeling regenval reislust remkabel reukloos reporter reisboek redactie regenjas reisplan relevant rekening remkabel reukloos regenpak reistijd rioolrat rondreis rolmodel roemloos ringworm roeibaan rijspoor robotarm roerloos rijpaard rijkaard rijksweg ritprijs rolstoel rijkelui roomsaus rookplek roomkaas roofbouw";
let wordString2 = "rotsvast rotswand rouwjaar rugspier rupsband rotsblok ruwharig rugsteun rozenhof rustoord rustplek rozentak rotskust rotsmoes rugzakje rustpunt rugzenuw rouwauto rotspunt rusthuis roulatie scharrel satijnen sancties sarcasme sandwich schaamte sabotage saxofoon sanitair saboteur scherpte schilfer schijfje schoenen schouder schreeuw scheutje schepijs schimmel scholier schuldig scholing schimmig schutter schepper schommel selectie sfeertje sierduif sjabloon schuitje serenade sergeant selfmade scoliose semafoon sierlijk sinister showdans semester seringen sjoelbak simulant silhouet showroom scriptie sinecure silicone skibroek slaappil slotfase slotstuk slokdarm slagroom slaapzak simkaart slagtand sloperij slijtage slagerij slijmerd slagveld slaaphut slagwerk slaapkop slagader slaapmat skipiste sneltram snijvlak solotoer snelheid snijwond sombrero smetvrij snijzaal sojaboon smeerlap sneakers snijboon snikheet smartlap soepbord sojamelk sluiting snijpunt snotneus smaakvol sojasaus smaakzin snijtand sluipweg snackbar sneltest snorhaar solarium souvenir spaarpot sporttas spectrum spontaan spierbal spitsuur spoornet spiritus spoorweg specerij spandoek spelfout spatader spinazie sportdag spatbord speeksel speelbal spoedwet stadsbus steenuil stampvol spitsuur stamboom steelpan stadsmus stamtaal spoeling spuitbus steenbok stamgast stadhuis sportdag steekmug stagiair splinter sprookje stadsbos stamppot stemtest stijfkop stiletto sterfbed sterfdag stinkbom stoflaag stiliste stemband stemming stoflong stofdoek stijlvol stichter stikstof stokdoof stoornis stopsein strohoed stuurman straling stortbad stomerij stukloon stomheid stortbui strijder stofwolk stoombad stroming strafbal stokroos stoofpot stoompan storting stuntman stokslag strafeis stopbord strateeg strohalm stropdas stuurlui subgroep sushibar synagoge synoniem teakhout subhoofd taalgrap techniek tatoeage tapasbar teambaas symbiose synthese tandplak tabtoets subvraag taxateur tandwiel symfonie subsidie tandarts survival symptoom taalfout tafereel tandzorg tegengif tekening theemuts tekenles tekstvak therapie tegelpad tentstok tentzeil theetijd thermaal tijdbalk tiptoets tekenset tenorsax terugval theedoek thuiskok tentakel terugweg tijdstip tegenbod telefoon tevreden tijdnood tekenaar tentdoek theehuis tijddruk telegram tochtgat tegenzin tipgever toekomst toonbaar touwbrug toverbos tramrail toonbank traangas tongriem topvrouw training topzwaar traditie toerisme toezicht tongzoen topploeg tragedie toernooi topscore tolerant tovenaar traplift topmodel topsport torentje trilhaar trimbaan trombose tuinboon tuinsets trekdier trimloop tuinbouw tweeslag treinrit trekdrop triangel triatlon trottoir tuinkers tweeling trouwdag tuindeur tribunes tweeluik trekhaak tuinhuis tumorcel trombone trouwpak uienring uitkomst uiensoep uitdraai uitschot uitlenen uierzalf uitheems uitbloei uitgroei uiengeur uitgifte uittocht uitstoot uitgaven uiteinde uitsnede underdog uitvaart uitstoot urineren urenlang uurbasis urologie vagebond vangrail verbruik vaagheid vaartuig vaccines variatie vastgoed veldfles veldmuis valsheid vaatdoek vakvrouw vechtjas vannacht vakantie vaatwand veeteelt veldslag vaarplan veerpont vakgroep vacature vanavond variabel verdriet verfrest verlegen vergrijp verftube verkoper verflaag vermoeid verrader vermogen vertaler verlegen verstand verschil viroloog visagist viskweek visrecht vijfhoek visstand vitamine virtuoos vitrages violiste veteraan visserij vioolles vierkamp vetzucht vinoloog vetplant vetkaars viespeuk viskraam vleesmes vliesdun voertuig voetstap volmacht voetstuk vleespan voordeur voetbank vliegles voegwerk vleesdag vlierbes volkoren vliering vleesjus voetzool vriesvak waarborg vuurshow voortent voorrang vrijheid waakhond voorwerp waakvlam waaghals vuurdoop vriendin vreetbui voorpoot voornaam voorruit waakzaam wachtrij waagstuk vuurwerk vormfout voortaan voorpret voorzorg waanidee vuurkorf vrieskou voortuin voorraad wanhopig walnoten washokje waterton weerslag wasrekje weekblad wanklank warhoofd wassalon waterval waterijs weertype wansmaak wasdraad wasserij weekeind weektaak waterkan weerbaar waterrat waslijst weekgeld weeffout waterski wastafel welvaart werkplan wijkteam wijnrank werkplek werkboek werkloos wielklem wijnfles wijngids wijkzorg werkvolk wensboom werklust wijnglas werkdruk werkstuk wijsneus wijnhuis westkust werkduur werkbank wijnstok whiplash woonboot zakenman zaaknaam wrakstuk windhond windhoos witbrood woonwens zaalarts zaadkiem woonwijk windjack wiskunde woestijn";
let wordList = wordString.split(" ")

let rightWay = [0, 4, 5, 1, 7, 3, 2, 6];
let leftWay = [0, 6, 2, 3, 7, 1, 5, 4];

let word;

let boxes = $('.grid-item:not(.center)').map(function() {return $(this)}).get()

const TIME_FOR_PAARDENSPRONG = 20;
let timeElapsed;
let timerInterval;
let rightWayRound;
let startPlace;
let paused = false;
let showingSolution = false;

function fillBoxes() {
    resetValues();
    startTimer();
    word = wordList[Math.floor(Math.random() * wordList.length)]
    rightWayRound = Math.random();
    startPlace = Math.floor(Math.random() * 8); // [0..7]
    if (rightWayRound > 0.5) {
        for (let i = 0; i < 8; i++) {
            boxes[rightWay[(startPlace + i)%8]].html(word.charAt(i).toUpperCase());
        }
    } else {
        for (let i = 0; i < 8; i++) {
            boxes[leftWay[(startPlace + i)%8]].html(word.charAt(i).toUpperCase());
        }
    }
}

function resetValues() {
    $('#answerDiv').css('display', 'none');
    timeElapsed = 0;
    paused = false;
    clearInterval(timerInterval);
    $('#answer').css("color", "white");
    $('#answer').val("");
    $('#giveSolution').html("Ik weet het!");
    $('.grid-item:not(.center)').each((index, element) => $(element).css({"color": "black", "background-color":"white"}));
}

function startTimer() {
    timerInterval = setInterval(() => {
        if (!paused) {
            timeElapsed += 0.05;
            timeLeft = TIME_FOR_PAARDENSPRONG - timeElapsed;
            
            let fraction = timeElapsed / TIME_FOR_PAARDENSPRONG;
            if (fraction < 1) {
                $('#circleTimer').attr('stroke-dasharray', `0 ${fraction * 283} 283`);
            }
        }
    }, 50)
}

function checkAnswer(input) {
    if (input.key == "Enter") {
        if ($('#answer').val().toUpperCase() == word.toUpperCase()) { // Correct
            $('#answer').css("color", "green");
            $('ul#times').append(`<li class="list-group-item list-group-item-success">Tijd gebruikt: ${timeElapsed.toFixed(2)}s</li>`);
            $('.grid-item').each((index, element) => $(element).css("color", "green"));
            showSolution();
        } else { // Incorrect
            $('#answer').css("color", "red");
            $('ul#times').append(`<li class="list-group-item list-group-item-danger">Tijd gebruikt: ${timeElapsed.toFixed(2)}s</li>`);
            $('.grid-item').each((index, element) => $(element).css("color", "red"));
            showSolution();
        }
    }
}

function giveSolution() {
    if (paused) {
        $('#giveSolution').html("Ik weet het!");
        paused = false;
    } else {
        $('#giveSolution').html("Laat tijd verder gaan.");
        $('#answerDiv').css('display', 'flex');
        $('#answer').val("");
        $('#answer').focus();
        $('#answer').trigger('click');
        paused = true;
    }
}

function resetTimer() {
    timeElapsed = 0;
}

function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}

async function showSolution() {
    if (showingSolution || word == undefined) {
        return;
    }
    paused = true;
    let currentWord = word;
    showingSolution = true;
    $('.grid-item:not(.center)').each((index, element) => $(element).css({"color": "black", "background-color":"white"}));
    if (rightWayRound > 0.5) {
        for (let i = 0; i < 8; i++) {
            if (currentWord != word) {
                break;
            }
            boxes[rightWay[(startPlace + i)%8]].css({"color": "white", "background-color": "black"});
            if (i < 3) {
                await sleep(1000);
            } else {
                await sleep(600);
            }
        }
    } else {
        for (let i = 0; i < 8; i++) {
            if (currentWord != word) {
                break;
            }
            boxes[leftWay[(startPlace + i)%8]].css({"color": "white", "background-color": "black"});
            if (i < 3) {
                await sleep(1000);
            } else {
                await sleep(600);
            }
        }
    }
    showingSolution = false;
}

$('#nieuwWoord').click(fillBoxes);
$('#resetTimer').click(resetTimer);
$('#showSolution').click(showSolution);
$('#giveSolution').click(giveSolution);
$('#answer').keyup(checkAnswer);
